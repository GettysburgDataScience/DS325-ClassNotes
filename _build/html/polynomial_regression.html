
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Polynomial Regression &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=720ed60b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=fb9458d3" />
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=720ed60b" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/styles/theme.css?v=a243ae73" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'polynomial_regression';</script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/searchtools.js?v=63a53a7d"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script src="_static/language_data.js?v=d4673a71"></script>
    <script src="_static/copybutton_funcs.js?v=776a791e"></script>
    <script src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="_static/scripts/bootstrap.js?v=7583a70d"></script>
    <script src="_static/scripts/fontawesome.js?v=9b125980"></script>
    <script src="_static/scripts/pydata-sphinx-theme.js?v=a1eb5d9f"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reading Assignments Review" href="reading_review.html" />
    <link rel="prev" title="Bias, Variance, and Regularization" href="regularization.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="My sample book - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to DS325 Applied Data Science
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setting Up</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_regression_01.html">Linear Regression (Part 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_regression_02.html">Linear Regression (Part 2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="regularization.html">Bias, Variance, and Regularization</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Polynomial Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="reading_review.html">Reading Assignments Review</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fpolynomial_regression.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/polynomial_regression.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Polynomial Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-polynomial">What is a polynomial?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#but-polynomials-aren-t-linear">But polynomials aren’t linear!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#engineering-polynomial-features">Engineering Polynomial features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-some-curvy-synthetic-data">Creating some curvy synthetic data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-models">Fitting the models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#displaying-the-model-results">Displaying the model results</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="polynomial-regression">
<h1>Polynomial Regression<a class="headerlink" href="#polynomial-regression" title="Link to this heading">#</a></h1>
<p>Sometimes our data just aren’t linear. We can extend the linear regression approach to fitting ‘curvy’ data in several ways. Today we’ll introduce polynomial regression.</p>
<section id="what-is-a-polynomial">
<h2>What is a polynomial?<a class="headerlink" href="#what-is-a-polynomial" title="Link to this heading">#</a></h2>
<p>An equation composed of variables, variables raised to powers (e.g. squared, cubed, etc), and/or the product of variables and variables raised to powers.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y = x^2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y = 5 x^3 + 4.5^x - 3.6\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y = x_1^2 + 3.7 x_1 x_2 +2.1 x_2^2\)</span></p></li>
</ul>
<p>And Taylor’s theorem tells us that any smooth curve can be approximated within some range arbitrarily closely by some polynomial (if you took calculus, this is the foundation of the Taylor Series).</p>
</section>
<section id="but-polynomials-aren-t-linear">
<h2>But polynomials aren’t linear!<a class="headerlink" href="#but-polynomials-aren-t-linear" title="Link to this heading">#</a></h2>
<p>True.</p>
<p>So we’re going to create new features from which we can build a polynomial and our equation will be linear with regards to these new features. Whenever we create new features from existing features, we call that <em><strong>feature engineering</strong></em>.</p>
<p>Take for example the polynomial expression:</p>
<div class="math notranslate nohighlight">
\[y = 5 + 3.1 x + 2.6 x^2 - 4 x^3\]</div>
<p>Now let’s make a new set of features:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
z_1 &amp;= x\\
z_2 &amp;= x^2\\
z_3 &amp;= x^3
\end{align*}
\end{split}\]</div>
<p>Now substituting our new variables into our polynomial:</p>
<div class="math notranslate nohighlight">
\[
y = 5 + 3.1 z_1 + 2.6 z_2 - 4 z_3
\]</div>
<p>This equation is linear with respect to our new features (<span class="math notranslate nohighlight">\(z_1, z_2, z_3\)</span>), so we can use linear regression to find the best fit coeffecients!</p>
<section id="engineering-polynomial-features">
<h3>Engineering Polynomial features<a class="headerlink" href="#engineering-polynomial-features" title="Link to this heading">#</a></h3>
<p>Scikit-learn provides a function <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html">PolynomialFeatures</a> that creates new polynomial features from our existing features. Let’s examine this function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolynomialFeatures</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">include_bias</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Notice, each column corresponds to one of our new features.</p>
</section>
<section id="creating-some-curvy-synthetic-data">
<h3>Creating some curvy synthetic data<a class="headerlink" href="#creating-some-curvy-synthetic-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_samples</span> <span class="o">=</span> <span class="mi">80</span>

<span class="c1"># Define polynomial coefficients for two different polynomials</span>
<span class="n">poly_coeff</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">my_poly</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">poly_coeff</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>  <span class="c1"># Polynomial function: -0.5*z^4 - 4.2*z^3 + 0.9*z + 2</span>

<span class="c1"># Generate random x data points</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">98</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_samples</span><span class="p">))</span>

<span class="c1"># Plug the x data points into the polynomial function and add some noise</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">my_poly</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_samples</span><span class="p">)</span>

<span class="c1"># x_range is an array of data points in the x direction. y_range is the polynomial plotted over that range.</span>
<span class="c1"># These will be used to display the models.</span>
<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y_range</span> <span class="o">=</span> <span class="n">my_poly</span><span class="p">(</span><span class="n">x_range</span><span class="p">)</span>

<span class="c1"># Plot the data points and polynomial curves</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>

<span class="c1"># Get y-axis limits for the plot</span>
<span class="n">my_ylims</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7eefe65e69c55b04ed8c8672f564996af82285a9068c3135f89809f61c46c371.png" src="_images/7eefe65e69c55b04ed8c8672f564996af82285a9068c3135f89809f61c46c371.png" />
</div>
</div>
</section>
<section id="fitting-the-models">
<h3>Fitting the models<a class="headerlink" href="#fitting-the-models" title="Link to this heading">#</a></h3>
<p>Suppose we were presented the data above, not having made it ourselves. How would we know what degree of polynomial to use? We wouldn’t.</p>
<p>So, we’re going to fit polynomials of different degrees and inspect the results. We’ll also fit Lasso, Ridge, and Elastic Net models to the data.</p>
<ul class="simple">
<li><p>Linear Regression with polynomial features up to degree 1, 2, 4, 8, and 16</p></li>
<li><p>Lasso, Ridge, and Elastic Net with polynomial features up to degree 16 (we’ll let regularization decide what stays and what goes)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Linear Regressions</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="c1"># Split the data into training and testing sets</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> 
                                                    <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Define the degrees of the polynomial features to be tested</span>
<span class="n">degs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>

<span class="c1"># Initialize a dictionary to store the models</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Loop over each degree</span>
<span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degs</span><span class="p">:</span>
    <span class="c1"># Create polynomial features</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>    
    <span class="n">Z_train</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
    <span class="n">Z_test</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
    <span class="n">z_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;xs^</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">deg</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>

    
    <span class="c1"># Standardize the features</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">Z_train_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Z_train</span><span class="p">)</span>
    <span class="n">Z_test_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Z_test</span><span class="p">)</span>

    <span class="c1"># Train a linear regression model on the scaled polynomial features</span>
    <span class="n">reg_poly</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">reg_poly</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Transform the x_range using the polynomial features and the scaler</span>
    <span class="c1"># These aren&#39;t data, they&#39;re x- and y-values used to plot the model</span>
    <span class="n">z_model</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_range</span><span class="p">))</span>
    <span class="n">y_model</span> <span class="o">=</span> <span class="n">reg_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">z_model</span><span class="p">)</span>

    <span class="c1"># Calculate the R^2 score for training and testing sets</span>
    <span class="n">R2_train</span> <span class="o">=</span> <span class="n">reg_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">R2_test</span> <span class="o">=</span> <span class="n">reg_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    
    <span class="c1"># Store the model and its details in the dictionary</span>
    <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Poly_</span><span class="si">{</span><span class="n">deg</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">models</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Poly </span><span class="si">{</span><span class="n">deg</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="n">z_names</span><span class="p">,</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">ss</span><span class="p">,</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">reg_poly</span><span class="p">,</span>
        <span class="n">z_model</span> <span class="o">=</span> <span class="n">z_model</span><span class="p">,</span>
        <span class="n">y_model</span> <span class="o">=</span> <span class="n">y_model</span><span class="p">,</span>
        <span class="n">R2_train</span> <span class="o">=</span> <span class="n">R2_train</span><span class="p">,</span>
        <span class="n">R2_test</span> <span class="o">=</span> <span class="n">R2_test</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Lasso</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">ElasticNet</span>

<span class="n">alpha_test</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">lasso_poly</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha_test</span><span class="p">)</span>
<span class="n">lasso_poly</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_model</span> <span class="o">=</span> <span class="n">lasso_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">z_model</span><span class="p">)</span>

<span class="n">R2_train</span> <span class="o">=</span> <span class="n">lasso_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">R2_test</span> <span class="o">=</span> <span class="n">lasso_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s1">&#39;lasso&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Lasso&#39;</span><span class="p">,</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="n">z_names</span><span class="p">,</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">ss</span><span class="p">,</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">lasso_poly</span><span class="p">,</span>
        <span class="n">y_model</span> <span class="o">=</span> <span class="n">y_model</span><span class="p">,</span>
        <span class="n">R2_train</span> <span class="o">=</span> <span class="n">R2_train</span><span class="p">,</span>
        <span class="n">R2_test</span> <span class="o">=</span> <span class="n">R2_test</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Ridge</span>

<span class="n">alpha_test</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">ridge_poly</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha_test</span><span class="p">)</span>
<span class="n">ridge_poly</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_model</span> <span class="o">=</span> <span class="n">ridge_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">z_model</span><span class="p">)</span>

<span class="n">R2_train</span> <span class="o">=</span> <span class="n">ridge_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">R2_test</span> <span class="o">=</span> <span class="n">ridge_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Ridge&#39;</span><span class="p">,</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="n">z_names</span><span class="p">,</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">ridge_poly</span><span class="p">,</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">ss</span><span class="p">,</span>
        <span class="n">y_model</span> <span class="o">=</span> <span class="n">y_model</span><span class="p">,</span>
        <span class="n">R2_train</span> <span class="o">=</span> <span class="n">R2_train</span><span class="p">,</span>
        <span class="n">R2_test</span> <span class="o">=</span> <span class="n">R2_test</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Elastic Net</span>

<span class="n">elastic_poly</span> <span class="o">=</span> <span class="n">ElasticNet</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha_test</span><span class="p">,</span> <span class="n">l1_ratio</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span>
<span class="n">elastic_poly</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_model</span> <span class="o">=</span> <span class="n">elastic_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">z_model</span><span class="p">)</span>

<span class="n">R2_train</span> <span class="o">=</span> <span class="n">elastic_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">R2_test</span> <span class="o">=</span> <span class="n">elastic_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s1">&#39;elastic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Elastic Net&#39;</span><span class="p">,</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="n">z_names</span><span class="p">,</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">ss</span><span class="p">,</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">elastic_poly</span><span class="p">,</span>
        <span class="n">y_model</span> <span class="o">=</span> <span class="n">y_model</span><span class="p">,</span>
        <span class="n">R2_train</span> <span class="o">=</span> <span class="n">R2_train</span><span class="p">,</span>
        <span class="n">R2_test</span> <span class="o">=</span> <span class="n">R2_test</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="displaying-the-model-results">
<h3>Displaying the model results<a class="headerlink" href="#displaying-the-model-results" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">my_poly</span><span class="p">(</span><span class="n">x_range</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;teal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;y_model&#39;</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">reg</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">$R^2 = $</span><span class="si">{</span><span class="n">reg</span><span class="p">[</span><span class="s2">&quot;R2_train&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>


    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">my_ylims</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;goldenrod&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;y_model&#39;</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>  
    
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;$R^2 = $</span><span class="si">{</span><span class="n">reg</span><span class="p">[</span><span class="s2">&quot;R2_test&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Training Set&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Testing Set&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f01fd672bc53fdba56cf5f6d6aba53fb63f71e03d1b23dc9feda482b1d4b1c69.png" src="_images/f01fd672bc53fdba56cf5f6d6aba53fb63f71e03d1b23dc9feda482b1d4b1c69.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># When we fit our model with standardized features, the coefficients we solve for are with respect to the scaled features</span>
<span class="c1"># This function converts the parameters back to the scale of the original features (before standardization)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">unscale_coefs</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="n">coef</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">scale_</span><span class="p">)</span>
    <span class="n">me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">mean_</span><span class="p">)</span>
    
    <span class="n">coef_unsc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">true_divide</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">sc</span><span class="p">)</span>
    <span class="n">intercept_unsc</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coef_unsc</span><span class="p">,</span> <span class="n">me</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">coef_unsc</span><span class="p">,</span> <span class="n">intercept_unsc</span>

<span class="c1"># A function to create a string of the equation of a model</span>
<span class="k">def</span><span class="w"> </span><span class="nf">model_string</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">coef</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">X_names</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">model_name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="c1"># A function to print the equation of a linear model</span>
    <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">intercept</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">intercept_</span>
        <span class="n">coef</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span>

    <span class="k">if</span> <span class="n">model_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">model_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;y =&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">model_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">:</span><span class="se">\n</span><span class="s1"> y =&#39;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">intercept</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">model_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span>
        
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">X_names</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">c</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">model_str</span><span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; - </span><span class="si">{</span><span class="o">-</span><span class="n">c</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">*</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model_str</span><span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; + </span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">*</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">return</span><span class="p">(</span><span class="n">model_str</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">coeff_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">nans</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">*</span><span class="mi">17</span>
<span class="n">coeff_df</span><span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nans</span>
<span class="n">coeff_df</span><span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poly_coeff</span><span class="p">))]</span> <span class="o">=</span> <span class="n">poly_coeff</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">model_eqs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
    
    <span class="n">reg</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
    
    <span class="n">coefs_unscaled</span><span class="p">,</span> <span class="n">intercept_unscaled</span> <span class="o">=</span> <span class="n">unscale_coefs</span><span class="p">(</span><span class="n">reg</span><span class="p">[</span><span class="s1">&#39;scaler&#39;</span><span class="p">],</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
  
    <span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">intercept_unscaled</span><span class="p">]),</span> <span class="n">coefs_unscaled</span><span class="p">))</span>
    <span class="n">coeff_df</span><span class="p">[</span><span class="n">title</span><span class="p">]</span> <span class="o">=</span> <span class="n">nans</span>
    <span class="n">coeff_df</span><span class="p">[</span><span class="n">title</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">))]</span> <span class="o">=</span> <span class="n">coeffs</span>
    
    <span class="c1"># Model strings with scaled model parameters</span>
    <span class="c1"># model_str = model_string(model = reg[&#39;model&#39;], X_names = reg[&#39;feature_names&#39;], model_name = reg[&#39;title&#39;])</span>
    
    <span class="c1"># Model strings with un-scaled model parameters</span>
    <span class="n">model_str</span> <span class="o">=</span> <span class="n">model_string</span><span class="p">(</span><span class="n">coef</span><span class="o">=</span><span class="n">coefs_unscaled</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="n">intercept_unscaled</span><span class="p">,</span> <span class="n">X_names</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">],</span> <span class="n">model_name</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>

    <span class="n">model_eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model_str</span><span class="p">)</span>


<span class="n">true_model_eq</span> <span class="o">=</span> <span class="n">model_string</span><span class="p">(</span><span class="n">coef</span> <span class="o">=</span> <span class="n">poly_coeff</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">poly_coeff</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_names</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">],</span> <span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;True model&#39;</span><span class="p">)</span>
<span class="n">model_eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">true_model_eq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
<span class="n">coeff_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>True</th>
      <th>Poly 1</th>
      <th>Poly 2</th>
      <th>Poly 4</th>
      <th>Poly 8</th>
      <th>Poly 16</th>
      <th>Lasso</th>
      <th>Ridge</th>
      <th>Elastic Net</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.00</td>
      <td>1.89</td>
      <td>2.12</td>
      <td>2.12</td>
      <td>2.12</td>
      <td>2.35</td>
      <td>1.89</td>
      <td>2.09</td>
      <td>1.86</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.90</td>
      <td>-2.12</td>
      <td>-2.10</td>
      <td>1.02</td>
      <td>0.38</td>
      <td>2.63</td>
      <td>-0.00</td>
      <td>0.01</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.00</td>
      <td></td>
      <td>-0.61</td>
      <td>-0.57</td>
      <td>-1.26</td>
      <td>-26.64</td>
      <td>-0.00</td>
      <td>-0.38</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-4.20</td>
      <td></td>
      <td></td>
      <td>-4.35</td>
      <td>-1.71</td>
      <td>-91.67</td>
      <td>-0.56</td>
      <td>-1.21</td>
      <td>-0.52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.50</td>
      <td></td>
      <td></td>
      <td>0.04</td>
      <td>4.88</td>
      <td>406.72</td>
      <td>-0.00</td>
      <td>-0.32</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-1.95</td>
      <td>845.30</td>
      <td>-2.42</td>
      <td>-1.15</td>
      <td>-0.58</td>
    </tr>
    <tr>
      <th>6</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-9.75</td>
      <td>-2567.79</td>
      <td>-0.00</td>
      <td>-0.22</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-0.27</td>
      <td>-3314.14</td>
      <td>-0.00</td>
      <td>-0.70</td>
      <td>-0.41</td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>5.66</td>
      <td>8352.32</td>
      <td>-0.00</td>
      <td>-0.04</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>9</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>6567.95</td>
      <td>-0.00</td>
      <td>-0.32</td>
      <td>-0.17</td>
    </tr>
    <tr>
      <th>10</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-15246.20</td>
      <td>-0.00</td>
      <td>0.10</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>11</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-7029.38</td>
      <td>-0.00</td>
      <td>-0.11</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>12</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>15772.43</td>
      <td>-0.00</td>
      <td>0.17</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>13</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>3911.09</td>
      <td>-0.00</td>
      <td>-0.03</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>14</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-8640.13</td>
      <td>-0.00</td>
      <td>0.18</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>15</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-895.20</td>
      <td>-0.00</td>
      <td>-0.03</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>16</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1949.14</td>
      <td>-0.00</td>
      <td>0.17</td>
      <td>-0.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">model_eqs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Poly 1:
 y = 1.89 - 2.12*xs^1
Poly 2:
 y = 2.12 - 2.10*xs^1 - 0.61*xs^2
Poly 4:
 y = 2.12 + 1.02*xs^1 - 0.57*xs^2 - 4.35*xs^3 + 0.04*xs^4
Poly 8:
 y = 2.12 + 0.38*xs^1 - 1.26*xs^2 - 1.71*xs^3 + 4.88*xs^4 - 1.95*xs^5 - 9.75*xs^6 - 0.27*xs^7 + 5.66*xs^8
Poly 16:
 y = 2.35 + 2.63*xs^1 - 26.64*xs^2 - 91.67*xs^3 + 406.72*xs^4 + 845.30*xs^5 - 2567.79*xs^6 - 3314.14*xs^7 + 8352.32*xs^8 + 6567.95*xs^9 - 15246.20*xs^10 - 7029.38*xs^11 + 15772.43*xs^12 + 3911.09*xs^13 - 8640.13*xs^14 - 895.20*xs^15 + 1949.14*xs^16
Lasso:
 y = 1.89 - 0.56*xs^3 - 2.42*xs^5
Ridge:
 y = 2.09 + 0.01*xs^1 - 0.38*xs^2 - 1.21*xs^3 - 0.32*xs^4 - 1.15*xs^5 - 0.22*xs^6 - 0.70*xs^7 - 0.04*xs^8 - 0.32*xs^9 + 0.10*xs^10 - 0.11*xs^11 + 0.17*xs^12 - 0.03*xs^13 + 0.18*xs^14 - 0.03*xs^15 + 0.17*xs^16
Elastic Net:
 y = 1.86 - 0.52*xs^3 - 0.58*xs^5 - 0.41*xs^7 - 0.17*xs^9
True model:
 y = 2.00 + 0.90*xs^1 - 4.20*xs^3 - 0.50*xs^4
</pre></div>
</div>
</div>
</div>
<p>Which model is best?</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="regularization.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Bias, Variance, and Regularization</p>
      </div>
    </a>
    <a class="right-next"
       href="reading_review.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Reading Assignments Review</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-polynomial">What is a polynomial?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#but-polynomials-aren-t-linear">But polynomials aren’t linear!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#engineering-polynomial-features">Engineering Polynomial features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-some-curvy-synthetic-data">Creating some curvy synthetic data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-models">Fitting the models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#displaying-the-model-results">Displaying the model results</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Eatai Roth, Gettysburg College
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>