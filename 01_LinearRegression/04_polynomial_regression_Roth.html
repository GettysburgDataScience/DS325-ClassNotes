
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Polynomial Regression &#8212; DS325 Applied Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=720ed60b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=fb9458d3" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=720ed60b" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/theme.css?v=a243ae73" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '01_LinearRegression/04_polynomial_regression_Roth';</script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/searchtools.js?v=63a53a7d"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/language_data.js?v=d4673a71"></script>
    <script src="../_static/copybutton_funcs.js?v=776a791e"></script>
    <script src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/scripts/bootstrap.js?v=7583a70d"></script>
    <script src="../_static/scripts/fontawesome.js?v=9b125980"></script>
    <script src="../_static/scripts/pydata-sphinx-theme.js?v=a1eb5d9f"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ds325_sticker.png" class="logo__image only-light" alt="DS325 Applied Data Science - Home"/>
    <img src="../_static/ds325_sticker.png" class="logo__image only-dark pst-js-only" alt="DS325 Applied Data Science - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to DS325 Applied Data Science
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Setting Up and Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00_Resources/setup.html">1. Setting Up</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Resources/genai_policy.html">2. Our course GenAI Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="00_reviewtopics.html">3. Linear Regression Review Topics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Regression</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00_what_is_a_model.html">1. What is a model?</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_linear_regression.html">2. Linear Regression (Part 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_linear_regression.html">3. Linear Regression (Part 2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_regularization.html">4. Bias, Variance, and Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_regularization_housing.html">5. Regularization Example: King County housing</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_polynomial_regression.html">6. Polynomial Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Classification</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../02_Classification/01_classification_intro.html">1. Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Classification/02_logistic_regression.html">2. Logistic Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Classification/03_trees_encoding.html">3. Trees and Ensemble methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Classification/04_trees_gridcv.html">4. Tree Methods (continued)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Assignments</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00_Assignments/ps00.html">PS00</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Assignments/ps00_Roth.html">PS00 (Solutions by Prof Roth)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Assignments/ps01.html">PS01 - (Not so) Simple Linear Regression</a></li>

<li class="toctree-l1"><a class="reference internal" href="../00_Assignments/ps02.html">PS02 - Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00_Assignments/mp01.html">Mini-Project 1 (and examples!)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F01_LinearRegression/04_polynomial_regression_Roth.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/01_LinearRegression/04_polynomial_regression_Roth.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Polynomial Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-polynomial">What is a polynomial?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#but-polynomials-aren-t-linear">But polynomials aren’t linear!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#engineering-polynomial-features">Engineering Polynomial features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-some-curvy-synthetic-data">Creating some curvy synthetic data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-models">Fitting the models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#displaying-the-model-results">Displaying the model results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-king-county-housing">Example: King County Housing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">Data cleaning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing">Pre-processing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-model">Fitting the model</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="polynomial-regression">
<h1>Polynomial Regression<a class="headerlink" href="#polynomial-regression" title="Link to this heading">#</a></h1>
<p>Sometimes our data just aren’t linear. We can extend the linear regression approach to fitting ‘curvy’ data in several ways. Today we’ll introduce polynomial regression.</p>
<section id="what-is-a-polynomial">
<h2>What is a polynomial?<a class="headerlink" href="#what-is-a-polynomial" title="Link to this heading">#</a></h2>
<p>An equation composed of variables, variables raised to powers (e.g. squared, cubed, etc), and/or the product of variables and variables raised to powers.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y = x^2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y = 5 x^3 + 4.5^x - 3.6\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y = x_1^2 + 3.7 x_1 x_2 +2.1 x_2^2\)</span></p></li>
</ul>
<p>And Taylor’s theorem tells us that any smooth curve can be approximated within some range arbitrarily closely by some polynomial (if you took calculus, this is the foundation of the Taylor Series).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">1.7</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

<span class="n">y1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="mf">1.445</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">y3</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="mf">1.667</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>

<span class="n">y8</span> <span class="o">=</span> <span class="n">y3</span> <span class="o">+</span> <span class="mf">0.3480041667</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> \
        <span class="o">+</span> <span class="mf">0.0083333333</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">5</span> \
        <span class="o">-</span> <span class="mf">0.0335244014</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">6</span> \
        <span class="o">-</span> <span class="mf">0.0001984127</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">7</span> \
        <span class="o">+</span> <span class="mf">0.0017300986</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">8</span> \
             
<span class="n">y14</span> <span class="o">=</span> <span class="mf">1.0</span> \
        <span class="o">+</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">x</span> \
        <span class="o">-</span> <span class="mf">1.445</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> \
        <span class="o">-</span> <span class="mf">0.1666666667</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> \
        <span class="o">+</span> <span class="mf">0.3480041667</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> \
        <span class="o">+</span> <span class="mf">0.0083333333</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">5</span> \
        <span class="o">-</span> <span class="mf">0.0335244014</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">6</span> \
        <span class="o">-</span> <span class="mf">0.0001984127</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">7</span> \
        <span class="o">+</span> <span class="mf">0.0017300986</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">8</span> \
        <span class="o">+</span> <span class="mf">0.0000027557</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">9</span> \
        <span class="o">-</span> <span class="mf">0.0000555554</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">10</span> \
        <span class="o">-</span> <span class="mf">0.0000000251</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">11</span> \
        <span class="o">+</span> <span class="mf">0.0000012163</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">12</span> \
        <span class="o">+</span> <span class="mf">0.0000000002</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">13</span> \
        <span class="o">-</span> <span class="mf">0.0000000193</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">14</span> \


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">sharex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;1st order&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;1st order&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;2nd order&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;2nd order&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;3rd order&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;3rd order&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y8</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;8th order&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;8th order&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y14</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;14th order&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;14th order&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/37e062f687e4a0df3d04e07ec515278eb1997fe0224b30c993fe7d1bb66e8277.png" src="../_images/37e062f687e4a0df3d04e07ec515278eb1997fe0224b30c993fe7d1bb66e8277.png" />
</div>
</div>
</section>
<section id="but-polynomials-aren-t-linear">
<h2>But polynomials aren’t linear!<a class="headerlink" href="#but-polynomials-aren-t-linear" title="Link to this heading">#</a></h2>
<p>True.</p>
<p>So we’re going to create new features from which we can build a polynomial and our equation will be linear with regards to these new features. Whenever we create new features from existing features, we call that <em><strong>feature engineering</strong></em>.</p>
<p>Take for example the polynomial expression:</p>
<div class="math notranslate nohighlight">
\[y = 5 + 3.1 x + 2.6 x^2 - 4 x^3\]</div>
<p>Now let’s make a new set of features:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
z_1 &amp;= x\\
z_2 &amp;= x^2\\
z_3 &amp;= x^3
\end{align*}
\end{split}\]</div>
<p>Now substituting our new variables into our polynomial:</p>
<div class="math notranslate nohighlight">
\[
y = 5 + 3.1 z_1 + 2.6 z_2 - 4 z_3
\]</div>
<p>This equation is linear with respect to our new features (<span class="math notranslate nohighlight">\(z_1, z_2, z_3\)</span>), so we can use linear regression to find the best fit coeffecients!</p>
<section id="engineering-polynomial-features">
<h3>Engineering Polynomial features<a class="headerlink" href="#engineering-polynomial-features" title="Link to this heading">#</a></h3>
<p>Scikit-learn provides a function <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html">PolynomialFeatures</a> that creates new polynomial features from our existing features. Let’s examine this function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolynomialFeatures</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">include_bias</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Notice, each column corresponds to one of our new features.</p>
</section>
<section id="creating-some-curvy-synthetic-data">
<h3>Creating some curvy synthetic data<a class="headerlink" href="#creating-some-curvy-synthetic-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_samples</span> <span class="o">=</span> <span class="mi">80</span>

<span class="c1"># Define polynomial coefficients for two different polynomials</span>
<span class="n">poly_coeff</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">my_poly</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">poly_coeff</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>  <span class="c1"># Polynomial function: -0.5*z^4 - 4.2*z^3 + 0.9*z + 2</span>

<span class="c1"># Generate random x data points</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">98</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_samples</span><span class="p">))</span>

<span class="c1"># Plug the x data points into the polynomial function and add some noise</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">my_poly</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_samples</span><span class="p">)</span>

<span class="c1"># x_range is an array of data points in the x direction. y_range is the polynomial plotted over that range.</span>
<span class="c1"># These will be used to display the models.</span>
<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y_range</span> <span class="o">=</span> <span class="n">my_poly</span><span class="p">(</span><span class="n">x_range</span><span class="p">)</span>

<span class="c1"># Plot the data points and polynomial curves</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>

<span class="c1"># Get y-axis limits for the plot</span>
<span class="n">my_ylims</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6ae113eb91a4c7ac4dd999ac4a6e4b3c02c06c5d7a46a123a877ff701edc4bfc.png" src="../_images/6ae113eb91a4c7ac4dd999ac4a6e4b3c02c06c5d7a46a123a877ff701edc4bfc.png" />
</div>
</div>
</section>
<section id="fitting-the-models">
<h3>Fitting the models<a class="headerlink" href="#fitting-the-models" title="Link to this heading">#</a></h3>
<p>Suppose we were presented the data above, not having made it ourselves. How would we know what degree of polynomial to use? We wouldn’t.</p>
<p>So, we’re going to fit polynomials of different degrees and inspect the results. We’ll also fit Lasso, Ridge, and Elastic Net models to the data.</p>
<ul class="simple">
<li><p>Linear Regression with polynomial features up to degree 1, 2, 4, 8, and 16</p></li>
<li><p>Lasso, Ridge, and Elastic Net with polynomial features up to degree 16 (we’ll let regularization decide what stays and what goes)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Linear Regressions</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="c1"># Split the data into training and testing sets</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> 
                                                    <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Define the degrees of the polynomial features to be tested</span>
<span class="n">degs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>

<span class="c1"># Initialize a dictionary to store the models</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Loop over each degree</span>
<span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degs</span><span class="p">:</span>
    <span class="c1"># Create polynomial features</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>    
    <span class="n">Z_train</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
    <span class="n">Z_test</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
    <span class="n">z_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;xs^</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">deg</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>

    
    <span class="c1"># Standardize the features</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">Z_train_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Z_train</span><span class="p">)</span>
    <span class="n">Z_test_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Z_test</span><span class="p">)</span>

    <span class="c1"># Train a linear regression model on the scaled polynomial features</span>
    <span class="n">reg_poly</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">reg_poly</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Transform the x_range using the polynomial features and the scaler</span>
    <span class="c1"># These aren&#39;t data, they&#39;re x- and y-values used to plot the model</span>
    <span class="n">z_model</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_range</span><span class="p">))</span>
    <span class="n">y_model</span> <span class="o">=</span> <span class="n">reg_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">z_model</span><span class="p">)</span>

    <span class="c1"># Calculate the R^2 score for training and testing sets</span>
    <span class="n">R2_train</span> <span class="o">=</span> <span class="n">reg_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">R2_test</span> <span class="o">=</span> <span class="n">reg_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    
    <span class="c1"># Store the model and its details in the dictionary</span>
    <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Poly_</span><span class="si">{</span><span class="n">deg</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">models</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Poly </span><span class="si">{</span><span class="n">deg</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="n">z_names</span><span class="p">,</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">ss</span><span class="p">,</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">reg_poly</span><span class="p">,</span>
        <span class="n">z_model</span> <span class="o">=</span> <span class="n">z_model</span><span class="p">,</span>
        <span class="n">y_model</span> <span class="o">=</span> <span class="n">y_model</span><span class="p">,</span>
        <span class="n">R2_train</span> <span class="o">=</span> <span class="n">R2_train</span><span class="p">,</span>
        <span class="n">R2_test</span> <span class="o">=</span> <span class="n">R2_test</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: divide by zero encountered in matmul
  return X @ coef_ + self.intercept_
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: overflow encountered in matmul
  return X @ coef_ + self.intercept_
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: invalid value encountered in matmul
  return X @ coef_ + self.intercept_
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Lasso</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">ElasticNet</span>

<span class="n">alpha_test</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">lasso_poly</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha_test</span><span class="p">)</span>
<span class="n">lasso_poly</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_model</span> <span class="o">=</span> <span class="n">lasso_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">z_model</span><span class="p">)</span>

<span class="n">R2_train</span> <span class="o">=</span> <span class="n">lasso_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">R2_test</span> <span class="o">=</span> <span class="n">lasso_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s1">&#39;lasso&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Lasso&#39;</span><span class="p">,</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="n">z_names</span><span class="p">,</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">ss</span><span class="p">,</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">lasso_poly</span><span class="p">,</span>
        <span class="n">y_model</span> <span class="o">=</span> <span class="n">y_model</span><span class="p">,</span>
        <span class="n">R2_train</span> <span class="o">=</span> <span class="n">R2_train</span><span class="p">,</span>
        <span class="n">R2_test</span> <span class="o">=</span> <span class="n">R2_test</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: divide by zero encountered in matmul
  return X @ coef_ + self.intercept_
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: overflow encountered in matmul
  return X @ coef_ + self.intercept_
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: invalid value encountered in matmul
  return X @ coef_ + self.intercept_
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Ridge</span>

<span class="n">alpha_test</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">ridge_poly</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha_test</span><span class="p">)</span>
<span class="n">ridge_poly</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_model</span> <span class="o">=</span> <span class="n">ridge_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">z_model</span><span class="p">)</span>

<span class="n">R2_train</span> <span class="o">=</span> <span class="n">ridge_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">R2_test</span> <span class="o">=</span> <span class="n">ridge_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Ridge&#39;</span><span class="p">,</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="n">z_names</span><span class="p">,</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">ridge_poly</span><span class="p">,</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">ss</span><span class="p">,</span>
        <span class="n">y_model</span> <span class="o">=</span> <span class="n">y_model</span><span class="p">,</span>
        <span class="n">R2_train</span> <span class="o">=</span> <span class="n">R2_train</span><span class="p">,</span>
        <span class="n">R2_test</span> <span class="o">=</span> <span class="n">R2_test</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/utils/extmath.py:203: RuntimeWarning: divide by zero encountered in matmul
  ret = a @ b
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/utils/extmath.py:203: RuntimeWarning: overflow encountered in matmul
  ret = a @ b
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/utils/extmath.py:203: RuntimeWarning: invalid value encountered in matmul
  ret = a @ b
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: divide by zero encountered in matmul
  return X @ coef_ + self.intercept_
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: overflow encountered in matmul
  return X @ coef_ + self.intercept_
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: invalid value encountered in matmul
  return X @ coef_ + self.intercept_
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Elastic Net</span>

<span class="n">elastic_poly</span> <span class="o">=</span> <span class="n">ElasticNet</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha_test</span><span class="p">,</span> <span class="n">l1_ratio</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span>
<span class="n">elastic_poly</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_model</span> <span class="o">=</span> <span class="n">elastic_poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">z_model</span><span class="p">)</span>

<span class="n">R2_train</span> <span class="o">=</span> <span class="n">elastic_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">R2_test</span> <span class="o">=</span> <span class="n">elastic_poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Z_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">models</span><span class="p">[</span><span class="s1">&#39;elastic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Elastic Net&#39;</span><span class="p">,</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="n">z_names</span><span class="p">,</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">ss</span><span class="p">,</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">elastic_poly</span><span class="p">,</span>
        <span class="n">y_model</span> <span class="o">=</span> <span class="n">y_model</span><span class="p">,</span>
        <span class="n">R2_train</span> <span class="o">=</span> <span class="n">R2_train</span><span class="p">,</span>
        <span class="n">R2_test</span> <span class="o">=</span> <span class="n">R2_test</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: divide by zero encountered in matmul
  return X @ coef_ + self.intercept_
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: overflow encountered in matmul
  return X @ coef_ + self.intercept_
/Users/eatai/.pyenv/versions/3.13.1/envs/datascience/lib/python3.13/site-packages/sklearn/linear_model/_base.py:279: RuntimeWarning: invalid value encountered in matmul
  return X @ coef_ + self.intercept_
</pre></div>
</div>
</div>
</div>
</section>
<section id="displaying-the-model-results">
<h3>Displaying the model results<a class="headerlink" href="#displaying-the-model-results" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">my_poly</span><span class="p">(</span><span class="n">x_range</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;teal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;y_model&#39;</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">reg</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">$R^2 = $</span><span class="si">{</span><span class="n">reg</span><span class="p">[</span><span class="s2">&quot;R2_train&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>


    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">my_ylims</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;goldenrod&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;y_model&#39;</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>  
    
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;$R^2 = $</span><span class="si">{</span><span class="n">reg</span><span class="p">[</span><span class="s2">&quot;R2_test&quot;</span><span class="p">]</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Training Set&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Testing Set&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/876e918e0e94b48ca9cdfad611a18054a1e2d6c7036c6c01b464cb2ff215b152.png" src="../_images/876e918e0e94b48ca9cdfad611a18054a1e2d6c7036c6c01b464cb2ff215b152.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># When we fit our model with standardized features, the coefficients we solve for are with respect to the scaled features</span>
<span class="c1"># This function converts the parameters back to the scale of the original features (before standardization)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">unscale_coefs</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="n">coef</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">scale_</span><span class="p">)</span>
    <span class="n">me</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">mean_</span><span class="p">)</span>
    
    <span class="n">coef_unsc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">true_divide</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">sc</span><span class="p">)</span>
    <span class="n">intercept_unsc</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coef_unsc</span><span class="p">,</span> <span class="n">me</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">coef_unsc</span><span class="p">,</span> <span class="n">intercept_unsc</span>

<span class="c1"># A function to create a string of the equation of a model</span>
<span class="k">def</span><span class="w"> </span><span class="nf">model_string</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">coef</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">X_names</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">model_name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="c1"># A function to print the equation of a linear model</span>
    <span class="k">if</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">intercept</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">intercept_</span>
        <span class="n">coef</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span>

    <span class="k">if</span> <span class="n">model_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">model_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;y =&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">model_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">:</span><span class="se">\n</span><span class="s1"> y =&#39;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">intercept</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">model_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span>
        
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">X_names</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">c</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">model_str</span><span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; - </span><span class="si">{</span><span class="o">-</span><span class="n">c</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">*</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model_str</span><span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; + </span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">*</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">return</span><span class="p">(</span><span class="n">model_str</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">coeff_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">nans</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">*</span><span class="mi">17</span>
<span class="n">coeff_df</span><span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nans</span>
<span class="n">coeff_df</span><span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poly_coeff</span><span class="p">))]</span> <span class="o">=</span> <span class="n">poly_coeff</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">model_eqs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
    
    <span class="n">reg</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
    
    <span class="n">coefs_unscaled</span><span class="p">,</span> <span class="n">intercept_unscaled</span> <span class="o">=</span> <span class="n">unscale_coefs</span><span class="p">(</span><span class="n">reg</span><span class="p">[</span><span class="s1">&#39;scaler&#39;</span><span class="p">],</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
  
    <span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">intercept_unscaled</span><span class="p">]),</span> <span class="n">coefs_unscaled</span><span class="p">))</span>
    <span class="n">coeff_df</span><span class="p">[</span><span class="n">title</span><span class="p">]</span> <span class="o">=</span> <span class="n">nans</span>
    <span class="n">coeff_df</span><span class="p">[</span><span class="n">title</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">))]</span> <span class="o">=</span> <span class="n">coeffs</span>
    
    <span class="c1"># Model strings with scaled model parameters</span>
    <span class="c1"># model_str = model_string(model = reg[&#39;model&#39;], X_names = reg[&#39;feature_names&#39;], model_name = reg[&#39;title&#39;])</span>
    
    <span class="c1"># Model strings with un-scaled model parameters</span>
    <span class="n">model_str</span> <span class="o">=</span> <span class="n">model_string</span><span class="p">(</span><span class="n">coef</span><span class="o">=</span><span class="n">coefs_unscaled</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="n">intercept_unscaled</span><span class="p">,</span> <span class="n">X_names</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">],</span> <span class="n">model_name</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>

    <span class="n">model_eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model_str</span><span class="p">)</span>


<span class="n">true_model_eq</span> <span class="o">=</span> <span class="n">model_string</span><span class="p">(</span><span class="n">coef</span> <span class="o">=</span> <span class="n">poly_coeff</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">poly_coeff</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_names</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">],</span> <span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;True model&#39;</span><span class="p">)</span>
<span class="n">model_eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">true_model_eq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
<span class="n">coeff_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>True</th>
      <th>Poly 1</th>
      <th>Poly 2</th>
      <th>Poly 4</th>
      <th>Poly 8</th>
      <th>Poly 16</th>
      <th>Lasso</th>
      <th>Ridge</th>
      <th>Elastic Net</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.00</td>
      <td>1.89</td>
      <td>2.12</td>
      <td>2.12</td>
      <td>2.12</td>
      <td>2.35</td>
      <td>1.89</td>
      <td>2.09</td>
      <td>1.86</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.90</td>
      <td>-2.12</td>
      <td>-2.10</td>
      <td>1.02</td>
      <td>0.38</td>
      <td>2.63</td>
      <td>-0.00</td>
      <td>0.01</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.00</td>
      <td></td>
      <td>-0.61</td>
      <td>-0.57</td>
      <td>-1.26</td>
      <td>-26.64</td>
      <td>-0.00</td>
      <td>-0.38</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-4.20</td>
      <td></td>
      <td></td>
      <td>-4.35</td>
      <td>-1.71</td>
      <td>-91.67</td>
      <td>-0.56</td>
      <td>-1.21</td>
      <td>-0.52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.50</td>
      <td></td>
      <td></td>
      <td>0.04</td>
      <td>4.88</td>
      <td>406.72</td>
      <td>-0.00</td>
      <td>-0.32</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-1.95</td>
      <td>845.30</td>
      <td>-2.42</td>
      <td>-1.15</td>
      <td>-0.58</td>
    </tr>
    <tr>
      <th>6</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-9.75</td>
      <td>-2567.79</td>
      <td>-0.00</td>
      <td>-0.22</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-0.27</td>
      <td>-3314.14</td>
      <td>-0.00</td>
      <td>-0.70</td>
      <td>-0.41</td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>5.66</td>
      <td>8352.32</td>
      <td>-0.00</td>
      <td>-0.04</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>9</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>6567.95</td>
      <td>-0.00</td>
      <td>-0.32</td>
      <td>-0.17</td>
    </tr>
    <tr>
      <th>10</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-15246.20</td>
      <td>-0.00</td>
      <td>0.10</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>11</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-7029.38</td>
      <td>-0.00</td>
      <td>-0.11</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>12</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>15772.43</td>
      <td>-0.00</td>
      <td>0.17</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>13</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>3911.09</td>
      <td>-0.00</td>
      <td>-0.03</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>14</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-8640.13</td>
      <td>-0.00</td>
      <td>0.18</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>15</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-895.20</td>
      <td>-0.00</td>
      <td>-0.03</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>16</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1949.14</td>
      <td>-0.00</td>
      <td>0.17</td>
      <td>-0.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">model_eqs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Poly 1:
 y = 1.89 - 2.12*xs^1
Poly 2:
 y = 2.12 - 2.10*xs^1 - 0.61*xs^2
Poly 4:
 y = 2.12 + 1.02*xs^1 - 0.57*xs^2 - 4.35*xs^3 + 0.04*xs^4
Poly 8:
 y = 2.12 + 0.38*xs^1 - 1.26*xs^2 - 1.71*xs^3 + 4.88*xs^4 - 1.95*xs^5 - 9.75*xs^6 - 0.27*xs^7 + 5.66*xs^8
Poly 16:
 y = 2.35 + 2.63*xs^1 - 26.64*xs^2 - 91.67*xs^3 + 406.72*xs^4 + 845.30*xs^5 - 2567.79*xs^6 - 3314.14*xs^7 + 8352.32*xs^8 + 6567.95*xs^9 - 15246.20*xs^10 - 7029.38*xs^11 + 15772.43*xs^12 + 3911.09*xs^13 - 8640.13*xs^14 - 895.20*xs^15 + 1949.14*xs^16
Lasso:
 y = 1.89 - 0.56*xs^3 - 2.42*xs^5
Ridge:
 y = 2.09 + 0.01*xs^1 - 0.38*xs^2 - 1.21*xs^3 - 0.32*xs^4 - 1.15*xs^5 - 0.22*xs^6 - 0.70*xs^7 - 0.04*xs^8 - 0.32*xs^9 + 0.10*xs^10 - 0.11*xs^11 + 0.17*xs^12 - 0.03*xs^13 + 0.18*xs^14 - 0.03*xs^15 + 0.17*xs^16
Elastic Net:
 y = 1.86 - 0.52*xs^3 - 0.58*xs^5 - 0.41*xs^7 - 0.17*xs^9
True model:
 y = 2.00 + 0.90*xs^1 - 4.20*xs^3 - 0.50*xs^4
</pre></div>
</div>
</div>
</div>
<p>Which model is best?</p>
</section>
</section>
<section id="example-king-county-housing">
<h2>Example: King County Housing<a class="headerlink" href="#example-king-county-housing" title="Link to this heading">#</a></h2>
<p>Can we do better fitting the King County Housing dataset with polynomial features?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LassoCV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
</pre></div>
</div>
</div>
</div>
<section id="data-cleaning">
<h3>Data cleaning<a class="headerlink" href="#data-cleaning" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">housing_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/GettysburgDataScience/datasets/refs/heads/main/kc_house_data.csv&#39;</span><span class="p">)</span>

<span class="n">housing_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">housing_df</span><span class="p">[</span><span class="s1">&#39;yr_renovated&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;yr_renovated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">housing_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">housing_df</span><span class="p">[</span><span class="s1">&#39;yr_renovated&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;yr_built&#39;</span><span class="p">]</span>
<span class="n">housing_df</span><span class="p">[</span><span class="s1">&#39;yr_sold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">housing_df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]))</span>
<span class="n">housing_df</span><span class="p">[</span><span class="s1">&#39;age_built&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">housing_df</span><span class="p">[</span><span class="s1">&#39;yr_sold&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">housing_df</span><span class="p">[</span><span class="s1">&#39;yr_built&#39;</span><span class="p">]</span>
<span class="n">housing_df</span><span class="p">[</span><span class="s1">&#39;age_reno&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">housing_df</span><span class="p">[</span><span class="s1">&#39;yr_sold&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">housing_df</span><span class="p">[</span><span class="s1">&#39;yr_renovated&#39;</span><span class="p">]</span>

<span class="n">columns_to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;zipcode&#39;</span><span class="p">,</span> <span class="s1">&#39;yr_built&#39;</span><span class="p">,</span> <span class="s1">&#39;yr_renovated&#39;</span><span class="p">]</span>
<span class="n">housing_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns_to_drop</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pre-processing">
<h3>Pre-processing<a class="headerlink" href="#pre-processing" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Train-test split</p></li>
<li><p>Polynomial feature engineering</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">housing_df</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">housing_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">target</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">X_train_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">feature_names</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
<span class="n">feature_names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;1&#39;, &#39;bedrooms&#39;, &#39;bathrooms&#39;, &#39;sqft_living&#39;, &#39;sqft_lot&#39;, &#39;floors&#39;,
       &#39;waterfront&#39;, &#39;view&#39;, &#39;condition&#39;, &#39;grade&#39;, &#39;sqft_above&#39;,
       &#39;sqft_basement&#39;, &#39;lat&#39;, &#39;long&#39;, &#39;sqft_living15&#39;, &#39;sqft_lot15&#39;,
       &#39;yr_sold&#39;, &#39;age_built&#39;, &#39;age_reno&#39;, &#39;bedrooms^2&#39;,
       &#39;bedrooms bathrooms&#39;, &#39;bedrooms sqft_living&#39;, &#39;bedrooms sqft_lot&#39;,
       &#39;bedrooms floors&#39;, &#39;bedrooms waterfront&#39;, &#39;bedrooms view&#39;,
       &#39;bedrooms condition&#39;, &#39;bedrooms grade&#39;, &#39;bedrooms sqft_above&#39;,
       &#39;bedrooms sqft_basement&#39;, &#39;bedrooms lat&#39;, &#39;bedrooms long&#39;,
       &#39;bedrooms sqft_living15&#39;, &#39;bedrooms sqft_lot15&#39;,
       &#39;bedrooms yr_sold&#39;, &#39;bedrooms age_built&#39;, &#39;bedrooms age_reno&#39;,
       &#39;bathrooms^2&#39;, &#39;bathrooms sqft_living&#39;, &#39;bathrooms sqft_lot&#39;,
       &#39;bathrooms floors&#39;, &#39;bathrooms waterfront&#39;, &#39;bathrooms view&#39;,
       &#39;bathrooms condition&#39;, &#39;bathrooms grade&#39;, &#39;bathrooms sqft_above&#39;,
       &#39;bathrooms sqft_basement&#39;, &#39;bathrooms lat&#39;, &#39;bathrooms long&#39;,
       &#39;bathrooms sqft_living15&#39;, &#39;bathrooms sqft_lot15&#39;,
       &#39;bathrooms yr_sold&#39;, &#39;bathrooms age_built&#39;, &#39;bathrooms age_reno&#39;,
       &#39;sqft_living^2&#39;, &#39;sqft_living sqft_lot&#39;, &#39;sqft_living floors&#39;,
       &#39;sqft_living waterfront&#39;, &#39;sqft_living view&#39;,
       &#39;sqft_living condition&#39;, &#39;sqft_living grade&#39;,
       &#39;sqft_living sqft_above&#39;, &#39;sqft_living sqft_basement&#39;,
       &#39;sqft_living lat&#39;, &#39;sqft_living long&#39;, &#39;sqft_living sqft_living15&#39;,
       &#39;sqft_living sqft_lot15&#39;, &#39;sqft_living yr_sold&#39;,
       &#39;sqft_living age_built&#39;, &#39;sqft_living age_reno&#39;, &#39;sqft_lot^2&#39;,
       &#39;sqft_lot floors&#39;, &#39;sqft_lot waterfront&#39;, &#39;sqft_lot view&#39;,
       &#39;sqft_lot condition&#39;, &#39;sqft_lot grade&#39;, &#39;sqft_lot sqft_above&#39;,
       &#39;sqft_lot sqft_basement&#39;, &#39;sqft_lot lat&#39;, &#39;sqft_lot long&#39;,
       &#39;sqft_lot sqft_living15&#39;, &#39;sqft_lot sqft_lot15&#39;,
       &#39;sqft_lot yr_sold&#39;, &#39;sqft_lot age_built&#39;, &#39;sqft_lot age_reno&#39;,
       &#39;floors^2&#39;, &#39;floors waterfront&#39;, &#39;floors view&#39;, &#39;floors condition&#39;,
       &#39;floors grade&#39;, &#39;floors sqft_above&#39;, &#39;floors sqft_basement&#39;,
       &#39;floors lat&#39;, &#39;floors long&#39;, &#39;floors sqft_living15&#39;,
       &#39;floors sqft_lot15&#39;, &#39;floors yr_sold&#39;, &#39;floors age_built&#39;,
       &#39;floors age_reno&#39;, &#39;waterfront^2&#39;, &#39;waterfront view&#39;,
       &#39;waterfront condition&#39;, &#39;waterfront grade&#39;,
       &#39;waterfront sqft_above&#39;, &#39;waterfront sqft_basement&#39;,
       &#39;waterfront lat&#39;, &#39;waterfront long&#39;, &#39;waterfront sqft_living15&#39;,
       &#39;waterfront sqft_lot15&#39;, &#39;waterfront yr_sold&#39;,
       &#39;waterfront age_built&#39;, &#39;waterfront age_reno&#39;, &#39;view^2&#39;,
       &#39;view condition&#39;, &#39;view grade&#39;, &#39;view sqft_above&#39;,
       &#39;view sqft_basement&#39;, &#39;view lat&#39;, &#39;view long&#39;,
       &#39;view sqft_living15&#39;, &#39;view sqft_lot15&#39;, &#39;view yr_sold&#39;,
       &#39;view age_built&#39;, &#39;view age_reno&#39;, &#39;condition^2&#39;,
       &#39;condition grade&#39;, &#39;condition sqft_above&#39;,
       &#39;condition sqft_basement&#39;, &#39;condition lat&#39;, &#39;condition long&#39;,
       &#39;condition sqft_living15&#39;, &#39;condition sqft_lot15&#39;,
       &#39;condition yr_sold&#39;, &#39;condition age_built&#39;, &#39;condition age_reno&#39;,
       &#39;grade^2&#39;, &#39;grade sqft_above&#39;, &#39;grade sqft_basement&#39;, &#39;grade lat&#39;,
       &#39;grade long&#39;, &#39;grade sqft_living15&#39;, &#39;grade sqft_lot15&#39;,
       &#39;grade yr_sold&#39;, &#39;grade age_built&#39;, &#39;grade age_reno&#39;,
       &#39;sqft_above^2&#39;, &#39;sqft_above sqft_basement&#39;, &#39;sqft_above lat&#39;,
       &#39;sqft_above long&#39;, &#39;sqft_above sqft_living15&#39;,
       &#39;sqft_above sqft_lot15&#39;, &#39;sqft_above yr_sold&#39;,
       &#39;sqft_above age_built&#39;, &#39;sqft_above age_reno&#39;, &#39;sqft_basement^2&#39;,
       &#39;sqft_basement lat&#39;, &#39;sqft_basement long&#39;,
       &#39;sqft_basement sqft_living15&#39;, &#39;sqft_basement sqft_lot15&#39;,
       &#39;sqft_basement yr_sold&#39;, &#39;sqft_basement age_built&#39;,
       &#39;sqft_basement age_reno&#39;, &#39;lat^2&#39;, &#39;lat long&#39;, &#39;lat sqft_living15&#39;,
       &#39;lat sqft_lot15&#39;, &#39;lat yr_sold&#39;, &#39;lat age_built&#39;, &#39;lat age_reno&#39;,
       &#39;long^2&#39;, &#39;long sqft_living15&#39;, &#39;long sqft_lot15&#39;, &#39;long yr_sold&#39;,
       &#39;long age_built&#39;, &#39;long age_reno&#39;, &#39;sqft_living15^2&#39;,
       &#39;sqft_living15 sqft_lot15&#39;, &#39;sqft_living15 yr_sold&#39;,
       &#39;sqft_living15 age_built&#39;, &#39;sqft_living15 age_reno&#39;,
       &#39;sqft_lot15^2&#39;, &#39;sqft_lot15 yr_sold&#39;, &#39;sqft_lot15 age_built&#39;,
       &#39;sqft_lot15 age_reno&#39;, &#39;yr_sold^2&#39;, &#39;yr_sold age_built&#39;,
       &#39;yr_sold age_reno&#39;, &#39;age_built^2&#39;, &#39;age_built age_reno&#39;,
       &#39;age_reno^2&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scale features</span>
<span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_poly</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_poly</span><span class="p">)</span>

<span class="n">ss_y</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">y_train_scaled</span> <span class="o">=</span> <span class="n">ss_y</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_test_scaled</span> <span class="o">=</span> <span class="n">ss_y</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="fitting-the-model">
<h3>Fitting the model<a class="headerlink" href="#fitting-the-model" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lasso = LassoCV(alphas=np.logspace(-4, 5, 30), cv=5, max_iter=20000)</span>
<span class="n">lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
<span class="n">lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train_scaled</span><span class="p">)</span>

<span class="c1"># print(f&#39;The best alpha = {lasso.alpha_:.5f}&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-1 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Lasso(alpha=0.01, max_iter=20000)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>Lasso</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.linear_model.Lasso.html">?<span>Documentation for Lasso</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>Lasso(alpha=0.01, max_iter=20000)</pre></div> </div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lasso</span><span class="o">.</span><span class="n">coef_</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(190,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assessing model</span>
<span class="n">y_pred_lasso_scaled</span> <span class="o">=</span> <span class="n">lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">y_train_lasso_scaled</span> <span class="o">=</span> <span class="n">lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>

<span class="n">y_pred_lasso</span> <span class="o">=</span> <span class="n">ss_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred_lasso_scaled</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">y_train_lasso</span> <span class="o">=</span> <span class="n">ss_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_train_lasso_scaled</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>


<span class="n">rmse_lasso_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_lasso</span><span class="p">))</span>
<span class="n">r2_lasso_train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_lasso</span><span class="p">)</span>

<span class="n">rmse_lasso_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lasso</span><span class="p">))</span>
<span class="n">r2_lasso_test</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lasso</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lasso Regression Performance (Standardized Target):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Train RMSE: </span><span class="si">{</span><span class="n">rmse_lasso_train</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Test  RMSE: </span><span class="si">{</span><span class="n">rmse_lasso_test</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Train R^2: </span><span class="si">{</span><span class="n">r2_lasso_train</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Test  R^2: </span><span class="si">{</span><span class="n">r2_lasso_test</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lasso Regression Performance (Standardized Target):

  Train RMSE: 170350.323
  Test  RMSE: 191220.120

  Train R^2: 0.759
  Test  R^2: 0.755
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lasso</span><span class="o">.</span><span class="n">feature_name</span><span class="p">,</span> <span class="n">lasso</span><span class="o">.</span><span class="n">coef_</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s1">&lt;3</span><span class="si">}</span><span class="s1">.</span><span class="se">\t</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">weight</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lasso</span><span class="o">.</span><span class="n">feature_name</span><span class="p">,</span> <span class="n">lasso</span><span class="o">.</span><span class="n">coef_</span><span class="p">)):</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s1">&lt;3</span><span class="si">}</span><span class="s1">.</span><span class="se">\t</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">weight</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="ne">AttributeError</span>: &#39;Lasso&#39; object has no attribute &#39;feature_name&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lasso_weights</span> <span class="o">=</span> <span class="n">lasso</span><span class="o">.</span><span class="n">coef_</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">lasso_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lasso_weights</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">lasso_features</span><span class="p">,</span> <span class="n">lasso_weights</span> <span class="o">=</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">lasso_idx</span><span class="p">],</span> <span class="n">lasso_weights</span><span class="p">[</span><span class="n">lasso_idx</span><span class="p">]</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lasso_features</span><span class="p">,</span> <span class="n">lasso_weights</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s1">&gt;3</span><span class="si">}</span><span class="s1">. </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1"># print(f&#39;{f}: {w}&#39;)  </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1. sqft_living grade: 0.89
  2. sqft_living15 age_built: 0.47
  3. sqft_living15 yr_sold: -0.34
  4. age_reno^2: 0.24
  5. lat age_built: -0.22
  6. sqft_living: -0.2
  7. condition sqft_living15: 0.18
  8. lat yr_sold: 0.18
  9. sqft_living yr_sold: -0.17
 10. age_reno: -0.17
 11. bathrooms grade: 0.16
 12. sqft_basement^2: -0.15
 13. bathrooms sqft_living: 0.14
 14. sqft_living sqft_lot: -0.12
 15. sqft_living waterfront: 0.12
 16. grade sqft_lot15: -0.11
 17. sqft_living15^2: 0.1
 18. sqft_lot15: 0.1
 19. sqft_lot: 0.1
 20. view grade: 0.09
 21. bathrooms age_built: -0.08
 22. sqft_living15 age_reno: -0.08
 23. sqft_lot age_built: -0.08
 24. bathrooms sqft_basement: 0.08
 25. sqft_basement sqft_living15: 0.07
 26. waterfront age_built: -0.07
 27. sqft_living age_built: 0.07
 28. waterfront sqft_living15: 0.07
 29. bedrooms sqft_basement: -0.07
 30. sqft_basement yr_sold: -0.07
 31. bathrooms: -0.06
 32. sqft_living age_reno: -0.06
 33. sqft_lot sqft_lot15: 0.06
 34. waterfront view: 0.05
 35. lat long: -0.05
 36. grade age_built: 0.05
 37. sqft_living sqft_lot15: -0.05
 38. sqft_basement age_built: 0.05
 39. sqft_lot sqft_living15: 0.04
 40. sqft_lot condition: 0.04
 41. age_built: -0.04
 42. grade sqft_basement: 0.04
 43. floors sqft_living15: -0.04
 44. sqft_above sqft_basement: 0.03
 45. sqft_lot^2: 0.03
 46. view^2: 0.03
 47. view condition: 0.03
 48. bedrooms bathrooms: -0.03
 49. view yr_sold: -0.03
 50. sqft_lot floors: -0.03
 51. view age_built: -0.03
 52. lat age_reno: -0.02
 53. grade^2: 0.02
 54. floors waterfront: -0.02
 55. condition long: 0.02
 56. yr_sold^2: 0.02
 57. floors age_built: -0.02
 58. view age_reno: 0.01
 59. bathrooms sqft_lot: -0.01
 60. waterfront sqft_basement: 0.01
 61. floors condition: 0.01
 62. waterfront sqft_lot15: -0.01
 63. view sqft_basement: -0.01
 64. view sqft_living15: -0.01
 65. view sqft_lot15: -0.01
 66. bedrooms age_reno: 0.01
 67. sqft_basement sqft_lot15: -0.01
 68. sqft_lot15 age_reno: -0.01
 69. sqft_lot sqft_basement: -0.01
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lasso</span><span class="o">.</span><span class="vm">__dict__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;eps&#39;: 0.001,
 &#39;n_alphas&#39;: 100,
 &#39;alphas&#39;: array([1.00000000e-04, 2.04335972e-04, 4.17531894e-04, 8.53167852e-04,
        1.74332882e-03, 3.56224789e-03, 7.27895384e-03, 1.48735211e-02,
        3.03919538e-02, 6.21016942e-02, 1.26896100e-01, 2.59294380e-01,
        5.29831691e-01, 1.08263673e+00, 2.21221629e+00, 4.52035366e+00,
        9.23670857e+00, 1.88739182e+01, 3.85662042e+01, 7.88046282e+01,
        1.61026203e+02, 3.29034456e+02, 6.72335754e+02, 1.37382380e+03,
        2.80721620e+03, 5.73615251e+03, 1.17210230e+04, 2.39502662e+04,
        4.89390092e+04, 1.00000000e+05]),
 &#39;fit_intercept&#39;: True,
 &#39;precompute&#39;: &#39;auto&#39;,
 &#39;max_iter&#39;: 10000,
 &#39;tol&#39;: 0.0001,
 &#39;copy_X&#39;: True,
 &#39;cv&#39;: 5,
 &#39;verbose&#39;: False,
 &#39;n_jobs&#39;: None,
 &#39;positive&#39;: False,
 &#39;random_state&#39;: None,
 &#39;selection&#39;: &#39;cyclic&#39;,
 &#39;n_features_in_&#39;: 190,
 &#39;mse_path_&#39;: array([[0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.89180316, 1.20726685, 0.96953765, 1.03617309, 0.89572111],
        [0.61494055, 0.90535503, 0.68757007, 0.74582816, 0.62102612],
        [0.40152871, 0.59298286, 0.45692753, 0.4971293 , 0.41579718],
        [0.26160077, 0.39826875, 0.30328714, 0.32531649, 0.28799199],
        [0.22435085, 0.3362106 , 0.25349595, 0.2730596 , 0.25527627],
        [0.21638433, 0.31678584, 0.24149237, 0.25906245, 0.24876538],
        [0.2124113 , 0.30608175, 0.2372611 , 0.25106381, 0.24384645],
        [0.20598215, 0.29606165, 0.22939919, 0.24740002, 0.23839712],
        [0.20240462, 0.28575614, 0.22258826, 0.25321991, 0.23462645],
        [0.20054573, 0.27330067, 0.21383269, 0.25715647, 0.22717136],
        [0.20171136, 0.26973237, 0.21164797, 0.26107853, 0.22409708],
        [0.20367525, 0.26920748, 0.21196848, 0.26270477, 0.22269935],
        [0.20333678, 0.27014953, 0.21128408, 0.26494306, 0.22244907],
        [0.2037451 , 0.27135266, 0.21153266, 0.26684794, 0.2228214 ]]),
 &#39;alpha_&#39;: np.float64(0.0008531678524172815),
 &#39;alphas_&#39;: array([1.00000000e+05, 4.89390092e+04, 2.39502662e+04, 1.17210230e+04,
        5.73615251e+03, 2.80721620e+03, 1.37382380e+03, 6.72335754e+02,
        3.29034456e+02, 1.61026203e+02, 7.88046282e+01, 3.85662042e+01,
        1.88739182e+01, 9.23670857e+00, 4.52035366e+00, 2.21221629e+00,
        1.08263673e+00, 5.29831691e-01, 2.59294380e-01, 1.26896100e-01,
        6.21016942e-02, 3.03919538e-02, 1.48735211e-02, 7.27895384e-03,
        3.56224789e-03, 1.74332882e-03, 8.53167852e-04, 4.17531894e-04,
        2.04335972e-04, 1.00000000e-04]),
 &#39;coef_&#39;: array([ 0.00000000e+00, -0.00000000e+00, -6.13225579e-02, -1.95759955e-01,
         9.60677217e-02, -0.00000000e+00,  0.00000000e+00, -0.00000000e+00,
        -0.00000000e+00, -0.00000000e+00, -0.00000000e+00, -1.26554504e-03,
         0.00000000e+00, -0.00000000e+00, -0.00000000e+00,  1.02202060e-01,
         1.21447651e-03, -3.83216425e-02, -1.66633827e-01, -0.00000000e+00,
        -2.64432368e-02, -0.00000000e+00, -0.00000000e+00,  0.00000000e+00,
         0.00000000e+00, -0.00000000e+00, -0.00000000e+00,  0.00000000e+00,
        -0.00000000e+00, -6.88723462e-02, -0.00000000e+00,  0.00000000e+00,
         0.00000000e+00, -0.00000000e+00, -0.00000000e+00,  0.00000000e+00,
         1.27126076e-02, -0.00000000e+00,  1.44941047e-01, -8.85053520e-03,
        -0.00000000e+00,  0.00000000e+00,  1.68055813e-03, -0.00000000e+00,
         1.55827985e-01,  0.00000000e+00,  7.93299235e-02, -0.00000000e+00,
         0.00000000e+00,  0.00000000e+00, -0.00000000e+00, -0.00000000e+00,
        -8.05664825e-02,  0.00000000e+00,  0.00000000e+00, -1.18783419e-01,
         0.00000000e+00,  1.16471831e-01,  0.00000000e+00,  0.00000000e+00,
         8.88986972e-01,  0.00000000e+00,  0.00000000e+00, -0.00000000e+00,
         0.00000000e+00,  0.00000000e+00, -4.58850038e-02, -1.66331757e-01,
         6.76866031e-02, -6.16544753e-02,  2.55892363e-02, -2.74740935e-02,
        -3.24001133e-03,  3.65725812e-03,  3.85213716e-02,  0.00000000e+00,
        -0.00000000e+00, -1.20745976e-02,  0.00000000e+00, -0.00000000e+00,
         3.63978720e-02,  6.17217901e-02,  0.00000000e+00, -7.59161515e-02,
        -0.00000000e+00,  0.00000000e+00, -2.03582722e-02, -0.00000000e+00,
         1.07076091e-02,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
        -0.00000000e+00,  0.00000000e+00, -4.03393053e-02, -0.00000000e+00,
        -0.00000000e+00, -1.86099329e-02, -0.00000000e+00,  0.00000000e+00,
         4.82584000e-02,  0.00000000e+00, -0.00000000e+00,  0.00000000e+00,
         8.63948354e-03,  0.00000000e+00, -0.00000000e+00,  6.99491737e-02,
        -5.87411833e-03,  0.00000000e+00, -7.47017173e-02,  0.00000000e+00,
         3.21623098e-02,  2.80411131e-02,  8.93569542e-02,  0.00000000e+00,
        -1.06803749e-02, -0.00000000e+00,  0.00000000e+00, -6.62172537e-03,
        -5.50108895e-03, -2.96588942e-02, -2.75635725e-02,  5.14110674e-03,
        -0.00000000e+00,  0.00000000e+00,  0.00000000e+00, -0.00000000e+00,
        -0.00000000e+00,  1.82477544e-02,  1.76094945e-01, -0.00000000e+00,
        -0.00000000e+00,  0.00000000e+00, -0.00000000e+00,  1.75300011e-02,
         0.00000000e+00,  3.93383646e-02, -0.00000000e+00,  0.00000000e+00,
        -0.00000000e+00, -1.08085096e-01, -0.00000000e+00,  4.88707167e-02,
         0.00000000e+00, -0.00000000e+00,  3.47283973e-02, -0.00000000e+00,
         0.00000000e+00,  0.00000000e+00, -0.00000000e+00, -0.00000000e+00,
         0.00000000e+00, -0.00000000e+00, -1.48503347e-01, -0.00000000e+00,
         0.00000000e+00,  7.17087129e-02, -7.47011584e-03, -7.45420093e-02,
         4.58120279e-02, -0.00000000e+00,  0.00000000e+00, -4.72021190e-02,
        -0.00000000e+00,  0.00000000e+00,  1.76363196e-01, -2.24078854e-01,
        -1.73905801e-02,  0.00000000e+00,  0.00000000e+00, -0.00000000e+00,
        -0.00000000e+00,  0.00000000e+00,  0.00000000e+00,  9.74126541e-02,
        -0.00000000e+00, -3.43893100e-01,  4.72225450e-01, -7.66331981e-02,
         7.36193036e-04,  1.45617154e-03, -0.00000000e+00, -1.38455134e-02,
         1.99448213e-02, -0.00000000e+00, -0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  2.41706315e-01]),
 &#39;intercept_&#39;: np.float64(-1.8079223714844204e-13),
 &#39;dual_gap_&#39;: np.float64(0.0003188384465280909),
 &#39;n_iter_&#39;: 10000}
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./01_LinearRegression"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-polynomial">What is a polynomial?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#but-polynomials-aren-t-linear">But polynomials aren’t linear!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#engineering-polynomial-features">Engineering Polynomial features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-some-curvy-synthetic-data">Creating some curvy synthetic data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-models">Fitting the models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#displaying-the-model-results">Displaying the model results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-king-county-housing">Example: King County Housing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleaning">Data cleaning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing">Pre-processing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-model">Fitting the model</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Eatai Roth, Gettysburg College
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>